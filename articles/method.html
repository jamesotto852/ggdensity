<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="ggdensity">
<title>The method argument • ggdensity</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="The method argument">
<meta property="og:description" content="ggdensity">
<meta property="og:image" content="https://jamesotto852.github.io/ggdensity/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ggdensity</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/method.html">The method argument</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/jamesotto852/ggdensity/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>The method argument</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/jamesotto852/ggdensity/blob/HEAD/vignettes/method.Rmd" class="external-link"><code>vignettes/method.Rmd</code></a></small>
      <div class="d-none name"><code>method.Rmd</code></div>
    </div>

    
    
<style>

img {
  border: 0px;
}

</style>
<p>Almost every function in <strong>ggdensity</strong> accepts a
<code>method</code> argument—this is true for <code><a href="../reference/geom_hdr.html">geom_hdr()</a></code>
and other layer functions (<code><a href="../reference/geom_hdr.html">geom_hdr_lines()</a></code>,
<code><a href="../reference/geom_hdr_points.html">geom_hdr_points()</a></code>, …), as well as <code><a href="../reference/get_hdr.html">get_hdr()</a></code>
and <code><a href="../reference/get_hdr_1d.html">get_hdr_1d()</a></code>. This vignette summarizes the many ways in
which the <code>method</code> argument can be specified; first looking
at it from a more basic perspective, then from the perspective of a
developer wanting to implement additional estimators.</p>
<div class="section level2">
<h2 id="using-ggdensitys-method_-functions">Using <strong>ggdensity</strong>’s <code>method_*()</code>
functions<a class="anchor" aria-label="anchor" href="#using-ggdensitys-method_-functions"></a>
</h2>
<p>First, let’s load the necessary packages and generate some sample
data.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://jamesotto852.github.io/ggdensity/">"ggdensity"</a></span><span class="op">)</span>; <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html" class="external-link">theme_set</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: ggplot2</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html" class="external-link">theme_update</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="co"># Suppressing legends for readability</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> </span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">500</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">500</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="method_files/figure-html/unnamed-chunk-2-1.png" width="80%" style="display: block; margin: auto;"></p>
<p>The easiest way to plot HDRs with <code><a href="../reference/geom_hdr.html">geom_hdr()</a></code> (or any
other layer function from <strong>ggdensity</strong>) with a specified
density estimator is to provide a character object to the
<code>method</code> argument:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="../reference/geom_hdr.html">geom_hdr</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"kde"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="../reference/geom_hdr.html">geom_hdr</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"mvnorm"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="../reference/geom_hdr.html">geom_hdr</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"histogram"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="../reference/geom_hdr.html">geom_hdr</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"freqpoly"</span><span class="op">)</span></span></code></pre></div>
<p><img src="method_files/figure-html/unnamed-chunk-3-1.png" width="45%"><img src="method_files/figure-html/unnamed-chunk-3-2.png" width="45%"><img src="method_files/figure-html/unnamed-chunk-3-3.png" width="45%"><img src="method_files/figure-html/unnamed-chunk-3-4.png" width="45%"></p>
<p>However, as of <strong>ggdensity</strong> v1.0.0 there is an
alternative approach—providing a <code>method_*()</code> function
call:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="../reference/geom_hdr.html">geom_hdr</a></span><span class="op">(</span>method <span class="op">=</span> <span class="fu"><a href="../reference/method_kde.html">method_kde</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="../reference/geom_hdr.html">geom_hdr</a></span><span class="op">(</span>method <span class="op">=</span> <span class="fu"><a href="../reference/method_mvnorm.html">method_mvnorm</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="../reference/geom_hdr.html">geom_hdr</a></span><span class="op">(</span>method <span class="op">=</span> <span class="fu"><a href="../reference/method_histogram.html">method_histogram</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="../reference/geom_hdr.html">geom_hdr</a></span><span class="op">(</span>method <span class="op">=</span> <span class="fu"><a href="../reference/method_freqpoly.html">method_freqpoly</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="method_files/figure-html/unnamed-chunk-4-1.png" width="45%"><img src="method_files/figure-html/unnamed-chunk-4-2.png" width="45%"><img src="method_files/figure-html/unnamed-chunk-4-3.png" width="45%"><img src="method_files/figure-html/unnamed-chunk-4-4.png" width="45%"></p>
<p>The default behaviors of these two approaches are the same and always
will be—in this way, they are completely interchangeable. However, the
<code>method_*()</code> function call is required to estimate HDRs with
non-default estimator parameters. For example, we can set the
<code>adjust</code> parameter to apply a multiplicative adjustment to
the heuristically determined bandwidth in <code><a href="../reference/method_kde.html">method_kde()</a></code>
(which itself uses the one computed by
<code><a href="https://rdrr.io/pkg/MASS/man/bandwidth.nrd.html" class="external-link">MASS::bandwidth.nrd()</a></code>):</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="../reference/geom_hdr.html">geom_hdr</a></span><span class="op">(</span>method <span class="op">=</span> <span class="fu"><a href="../reference/method_kde.html">method_kde</a></span><span class="op">(</span>adjust <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="method_files/figure-html/unnamed-chunk-5-1.png" width="80%" style="display: block; margin: auto;"></p>
<p>The relevant parameters for each method are documented in their
respective <code>?method_*</code> help pages. Note that these parameters
can not be provided to <code><a href="../reference/geom_hdr.html">geom_hdr()</a></code> or
<code><a href="../reference/geom_hdr.html">stat_hdr()</a></code> and thus are not accessible if a character value
is provided to <code>method</code>.</p>
<p>The <code>method</code> argument of <code><a href="../reference/get_hdr.html">get_hdr()</a></code> functions
in the same way:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_hdr.html">get_hdr</a></span><span class="op">(</span><span class="va">df</span>, method <span class="op">=</span> <span class="fu"><a href="../reference/method_kde.html">method_kde</a></span><span class="op">(</span>adjust <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 3</span></span>
<span><span class="co">#&gt;  $ df_est:'data.frame':  10000 obs. of  5 variables:</span></span>
<span><span class="co">#&gt;   ..$ x               : num [1:10000] -3.01 -2.94 -2.87 -2.8 -2.73 ...</span></span>
<span><span class="co">#&gt;   ..$ y               : num [1:10000] -3 -3 -3 -3 -3 ...</span></span>
<span><span class="co">#&gt;   ..$ fhat            : num [1:10000] 4.72e-17 1.30e-15 2.88e-14 5.16e-13 7.44e-12 ...</span></span>
<span><span class="co">#&gt;   ..$ fhat_discretized: num [1:10000] 2.00e-19 5.50e-18 1.22e-16 2.18e-15 3.15e-14 ...</span></span>
<span><span class="co">#&gt;   ..$ hdr             : num [1:10000] 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">#&gt;  $ breaks: Named num [1:5] 0.00422 0.01273 0.03024 0.07544 Inf</span></span>
<span><span class="co">#&gt;   ..- attr(*, "names")= chr [1:5] "99%" "95%" "80%" "50%" ...</span></span>
<span><span class="co">#&gt;  $ data  :'data.frame':  500 obs. of  3 variables:</span></span>
<span><span class="co">#&gt;   ..$ x             : num [1:500] -0.626 0.184 -0.836 1.595 0.33 ...</span></span>
<span><span class="co">#&gt;   ..$ y             : num [1:500] 0.0773 -0.2969 -1.1832 0.0113 0.9916 ...</span></span>
<span><span class="co">#&gt;   ..$ hdr_membership: num [1:500] 0.5 0.5 0.8 0.8 0.5 0.95 0.8 0.5 0.5 0.5 ...</span></span></code></pre></div>
<p>For details on the output of <code><a href="../reference/get_hdr.html">get_hdr()</a></code>, see
<code><a href="../reference/get_hdr.html">?get_hdr</a></code>.</p>
<div class="section level3">
<h3 id="method__1d-functions">
<code>method_*_1d()</code> functions<a class="anchor" aria-label="anchor" href="#method__1d-functions"></a>
</h3>
<p>In <strong>ggdensity</strong>, it is possible to estimate and plot
1-dimensional HDRs with <code><a href="../reference/geom_hdr_rug.html">geom_hdr_rug()</a></code> and
<code><a href="../reference/get_hdr_1d.html">get_hdr_1d()</a></code>. These functions also accept a
<code>method</code> argument, but they do not accept the previously
discussed <code>method_*()</code> functions. Instead they accept the
1-dimensional analogues: <code>method_*_1d()</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_hdr_rug.html">geom_hdr_rug</a></span><span class="op">(</span>method <span class="op">=</span> <span class="fu"><a href="../reference/method_kde_1d.html">method_kde_1d</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_hdr_rug.html">geom_hdr_rug</a></span><span class="op">(</span>method <span class="op">=</span> <span class="fu"><a href="../reference/method_norm_1d.html">method_norm_1d</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_hdr_rug.html">geom_hdr_rug</a></span><span class="op">(</span>method <span class="op">=</span> <span class="fu"><a href="../reference/method_histogram_1d.html">method_histogram_1d</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_hdr_rug.html">geom_hdr_rug</a></span><span class="op">(</span>method <span class="op">=</span> <span class="fu"><a href="../reference/method_freqpoly_1d.html">method_freqpoly_1d</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="method_files/figure-html/unnamed-chunk-7-1.png" width="45%"><img src="method_files/figure-html/unnamed-chunk-7-2.png" width="45%"><img src="method_files/figure-html/unnamed-chunk-7-3.png" width="45%"><img src="method_files/figure-html/unnamed-chunk-7-4.png" width="45%"></p>
<p>Just like we saw with <code><a href="../reference/geom_hdr.html">geom_hdr()</a></code>,
<code><a href="../reference/geom_hdr_rug.html">geom_hdr_rug()</a></code> also accepts character values for
<code>method</code>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_hdr_rug.html">geom_hdr_rug</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"kde"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_hdr_rug.html">geom_hdr_rug</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"norm"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_hdr_rug.html">geom_hdr_rug</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"histogram"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_hdr_rug.html">geom_hdr_rug</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"freqpoly"</span><span class="op">)</span></span></code></pre></div>
<p><img src="method_files/figure-html/unnamed-chunk-8-1.png" width="45%"><img src="method_files/figure-html/unnamed-chunk-8-2.png" width="45%"><img src="method_files/figure-html/unnamed-chunk-8-3.png" width="45%"><img src="method_files/figure-html/unnamed-chunk-8-4.png" width="45%"></p>
<p>Because the return values of the <code>method_*()</code> functions
are incompatible with the 1-dimensional HDR estimation procedure, if a
2-dimensional method is specified the following error message is
issued:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_hdr_rug.html">geom_hdr_rug</a></span><span class="op">(</span>method <span class="op">=</span> <span class="fu"><a href="../reference/method_kde.html">method_kde</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="co">#&gt; Warning: Computation failed in `stat_hdr_rug()`</span></span>
<span><span class="co">#&gt; Caused by error in `get_hdr_1d()`:</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> Invalid `method` argument -- did you forget the `_1d()`?</span></span></code></pre></div>
<p>Lastly, we see that the <code>method</code> argument of
<code><a href="../reference/get_hdr_1d.html">get_hdr_1d()</a></code> behaves similarly.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_hdr_1d.html">get_hdr_1d</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">x</span>, method <span class="op">=</span> <span class="fu"><a href="../reference/method_kde_1d.html">method_kde_1d</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 3</span></span>
<span><span class="co">#&gt;  $ df_est:'data.frame':  512 obs. of  4 variables:</span></span>
<span><span class="co">#&gt;   ..$ x               : num [1:512] -3.01 -2.99 -2.98 -2.97 -2.95 ...</span></span>
<span><span class="co">#&gt;   ..$ fhat            : num [1:512] 0.00728 0.00748 0.00769 0.00789 0.00809 ...</span></span>
<span><span class="co">#&gt;   ..$ fhat_discretized: num [1:512] 9.73e-05 1.00e-04 1.03e-04 1.05e-04 1.08e-04 ...</span></span>
<span><span class="co">#&gt;   ..$ hdr             : num [1:512] 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">#&gt;  $ breaks: Named num [1:5] 0.0188 0.0562 0.1601 0.3146 Inf</span></span>
<span><span class="co">#&gt;   ..- attr(*, "names")= chr [1:5] "99%" "95%" "80%" "50%" ...</span></span>
<span><span class="co">#&gt;  $ data  :'data.frame':  500 obs. of  2 variables:</span></span>
<span><span class="co">#&gt;   ..$ x             : num [1:500] -0.626 0.184 -0.836 1.595 0.33 ...</span></span>
<span><span class="co">#&gt;   ..$ hdr_membership: num [1:500] 0.5 0.5 0.8 0.95 0.5 0.8 0.5 0.8 0.5 0.5 ...</span></span></code></pre></div>
<p>Again, for details on the above output of <code><a href="../reference/get_hdr_1d.html">get_hdr_1d()</a></code>,
see <code><a href="../reference/get_hdr_1d.html">?get_hdr_1d</a></code>.</p>
</div>
</div>
<div class="section level2">
<h2 id="a-detailed-look-at-method_-functions">A detailed look at <code>method_*()</code> functions<a class="anchor" aria-label="anchor" href="#a-detailed-look-at-method_-functions"></a>
</h2>
<p>Now that we understand the ways in which <code>method</code> can be
specified let’s look at the internals of the <code>method_*()</code>
functions. Note: the implementations discussed in this section depend
heavily on topics in functional programming, especially <a href="https://adv-r.hadley.nz/environments.html?q=closures#function-environments" class="external-link">closures</a>
and <a href="https://adv-r.hadley.nz/function-factories.html" class="external-link">function
factories</a>. While not necessary, a good understanding of these ideas
is helpful—the linked chapters from Hadley Wickham’s <em>Advanced R</em>
are a great place to start.</p>
<p>Looking at the definition of <code><a href="../reference/method_kde.html">method_kde()</a></code>, we see that
it is a function of <code>h</code> and <code>adjust</code>, returning a
closure with arguments <code>data</code>, <code>n</code>,
<code>rangex</code>, and <code>rangey</code>. The closure passes the
<code>x</code> and <code>y</code> columns of <code>data</code> to
<code><a href="https://rdrr.io/pkg/MASS/man/kde2d.html" class="external-link">MASS::kde2d()</a></code>, returning the estimated density evaluated on
a grid with columns <code>x</code>, <code>y</code>, and
<code>fhat</code>. This closure is what <code><a href="../reference/geom_hdr.html">geom_hdr()</a></code> expects
as its <code>method</code> argument, and is how the HDRs are estimated
(via <code><a href="../reference/get_hdr.html">get_hdr()</a></code>).</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>method_kde</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span> (<span class="at">h =</span> <span class="cn">NULL</span>, <span class="at">adjust =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>)) </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">function</span>(data, n, rangex, rangey) {</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">is.null</span>(h)) {</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>            h <span class="ot">&lt;-</span> <span class="fu">c</span>(MASS<span class="sc">::</span><span class="fu">bandwidth.nrd</span>(data<span class="sc">$</span>x), MASS<span class="sc">::</span><span class="fu">bandwidth.nrd</span>(data<span class="sc">$</span>y))</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>        h <span class="ot">&lt;-</span> h <span class="sc">*</span> adjust</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>        kdeout <span class="ot">&lt;-</span> MASS<span class="sc">::</span><span class="fu">kde2d</span>(<span class="at">x =</span> data<span class="sc">$</span>x, <span class="at">y =</span> data<span class="sc">$</span>y, <span class="at">n =</span> n, </span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">h =</span> h, <span class="at">lims =</span> <span class="fu">c</span>(rangex, rangey))</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>        df <span class="ot">&lt;-</span> <span class="fu">with</span>(kdeout, <span class="fu">expand.grid</span>(<span class="at">x =</span> x, <span class="at">y =</span> y))</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>        df<span class="sc">$</span>fhat <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(kdeout<span class="sc">$</span>z)</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>        df</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="sc">&lt;</span>bytecode<span class="sc">:</span> <span class="dv">0x5604861079f0</span><span class="sc">&gt;</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a><span class="er">&lt;</span>environment<span class="sc">:</span> namespace<span class="sc">:</span>ggdensity<span class="sc">&gt;</span></span></code></pre></div>
<p>Both <code><a href="../reference/method_histogram.html">method_histogram()</a></code> and
<code><a href="../reference/method_freqpoly.html">method_freqpoly()</a></code> behave similarly, accepting parameters
governing the density estimation procedure and returning a closure with
arguments <code>data</code>, <code>n</code>, <code>rangex</code>, and
<code>rangey</code>. However, these functions are significantly more
complicated as the density estimation procedures are implemented
entirely in <strong>ggdensity</strong>.</p>
<p><code><a href="../reference/method_mvnorm.html">method_mvnorm()</a></code> is different in a few ways. The closure
it returns is a function of just one argument: <code>data</code>. This
is because it does not return the estimated density evaluated on a grid.
Instead, it returns yet another closure with (vectorized) arguments
<code>x</code> and <code>y</code>. As in <code><a href="../reference/method_kde.html">method_kde()</a></code>, the
return value of the closure is a representation of the estimated pdf.
The difference is the manner in which the pdf is represented. Whereas
before we had a pdf defined by a discrete approximation on a grid, we
now have an explicit definition of the pdf in terms of <code>x</code>
and <code>y</code>.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>method_mvnorm</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span> () </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">function</span>(data) {</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>        data_matrix <span class="ot">&lt;-</span> <span class="fu">with</span>(data, <span class="fu">cbind</span>(x, y))</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>        mu_hat <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(data_matrix)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>        R <span class="ot">&lt;-</span> <span class="fu">chol</span>(<span class="fu">cov</span>(data_matrix))</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">function</span>(x, y) {</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>            X <span class="ot">&lt;-</span> <span class="fu">cbind</span>(x, y)</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>            tmp <span class="ot">&lt;-</span> <span class="fu">backsolve</span>(R, <span class="fu">t</span>(X) <span class="sc">-</span> mu_hat, <span class="at">transpose =</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>            logretval <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">sum</span>(<span class="fu">log</span>(<span class="fu">diag</span>(R))) <span class="sc">-</span> <span class="fu">log</span>(<span class="dv">2</span> <span class="sc">*</span> pi) <span class="sc">-</span> <span class="fl">0.5</span> <span class="sc">*</span> </span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>                <span class="fu">colSums</span>(tmp<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>            <span class="fu">exp</span>(logretval)</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a><span class="sc">&lt;</span>bytecode<span class="sc">:</span> <span class="dv">0x560485cfc060</span><span class="sc">&gt;</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a><span class="er">&lt;</span>environment<span class="sc">:</span> namespace<span class="sc">:</span>ggdensity<span class="sc">&gt;</span></span></code></pre></div>
<p>To summarize each of the above cases: in the first example, the
<code>method_*()</code> function returned a closure with arguments
<code>data</code>, <code>n</code>, <code>rangex</code>, and
<code>rangey</code> which itself returned the estimated density
evaluated on a grid; in the second, the <code>method_*()</code> function
returned a closure with a single argument, <code>data</code>, which
itself returned a closure with arguments <code>x</code> and
<code>y</code>, representing the estimated density explicitly. In both
cases, the <code>method_*()</code> function can have any number of
parameters governing the density estimation procedure.</p>
<p>These are the two ways the <code>method</code> argument may be
specified. The first is necessary for cases in which an explicit
definition of the estimated density is not computationally feasible (for
example, KDEs). The second is an easier option for the cases in which a
closed form of the estimated density is available (for example,
parametric estimators).</p>
<p>Let’s look at how we might define our own <code>method_*()</code>
functions in each case, beginning with a simple parametric
estimator.</p>
<div class="section level3">
<h3 id="implementing-a-method-returning-a-pdf">Implementing a method returning a PDF<a class="anchor" aria-label="anchor" href="#implementing-a-method-returning-a-pdf"></a>
</h3>
<p>In <strong>ggdensity</strong>, <code><a href="../reference/method_mvnorm.html">method_mvnorm()</a></code> estimates
HDRs based on the parametric multivariate normal model. If we wanted to
fit a simpler model in which the data is further assumed to be
independent, we could implement <code>method_mvnorm_ind()</code>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">method_mvnorm_ind</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="kw">function</span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">{</span></span>
<span>    </span>
<span>    <span class="va">xbar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">x</span><span class="op">)</span></span>
<span>    <span class="va">ybar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">y</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">sx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">x</span><span class="op">)</span></span>
<span>    <span class="va">sy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">y</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># joint pdf is simply the product of the marginals</span></span>
<span>    <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">xbar</span>, <span class="va">sx</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">ybar</span>, <span class="va">sy</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span><span class="op">}</span></span></code></pre></div>
<p>To use our <code>method_mvnorm_ind()</code>, we just need to supply
it to <code><a href="../reference/geom_hdr.html">geom_hdr()</a></code>’s <code>method</code> argument.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_hdr.html">geom_hdr</a></span><span class="op">(</span>method <span class="op">=</span> <span class="fu">method_mvnorm_ind</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="method_files/figure-html/unnamed-chunk-14-1.png" width="80%" style="display: block; margin: auto;"></p>
<p>If we transform our data to have non-zero covariance we still see the
major and minor axes of the contours coincide with the plot axes—exactly
what we would expect with this (incorrectly) constrained model.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="va">pi</span><span class="op">/</span><span class="fl">6</span><span class="op">)</span>, <span class="op">-</span><span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="va">pi</span><span class="op">/</span><span class="fl">6</span><span class="op">)</span>,</span>
<span>  <span class="fl">1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="va">pi</span><span class="op">/</span><span class="fl">6</span><span class="op">)</span>,  <span class="fl">1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="va">pi</span><span class="op">/</span><span class="fl">6</span><span class="op">)</span></span>
<span><span class="op">)</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_rot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">A</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">df_rot</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df_rot</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_hdr.html">geom_hdr</a></span><span class="op">(</span>method <span class="op">=</span> <span class="fu">method_mvnorm_ind</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">.4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html" class="external-link">coord_fixed</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">6</span>, <span class="fl">6</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">6</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="method_files/figure-html/unnamed-chunk-15-1.png" width="80%" style="display: block; margin: auto;"></p>
<p>Notice, <code>method_mvnorm_ind()</code> accepts no arguments. The
density estimation procedure is so simple that there are no parameters
to govern it. To allow for circular models in which the fitted variances
are required to be equal, we can implement a <code>circular</code>
argument.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">method_mvnorm_ind</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">circular</span> <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="kw">function</span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">{</span></span>
<span>    </span>
<span>    <span class="va">xbar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">x</span><span class="op">)</span></span>
<span>    <span class="va">ybar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">y</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">circular</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">sx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">x</span> <span class="op">-</span> <span class="va">xbar</span>, <span class="va">data</span><span class="op">$</span><span class="va">y</span> <span class="op">-</span> <span class="va">ybar</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="va">sy</span> <span class="op">&lt;-</span> <span class="va">sx</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>      <span class="va">sx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">x</span><span class="op">)</span></span>
<span>      <span class="va">sy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">y</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    </span>
<span>    <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">xbar</span>, <span class="va">sx</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">ybar</span>, <span class="va">sy</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span><span class="op">}</span></span></code></pre></div>
<p>Now, the contours are perfectly circular.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df_rot</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_hdr.html">geom_hdr</a></span><span class="op">(</span>method <span class="op">=</span> <span class="fu">method_mvnorm_ind</span><span class="op">(</span>circular <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">.4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html" class="external-link">coord_fixed</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">6</span>, <span class="fl">6</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">6</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="method_files/figure-html/unnamed-chunk-17-1.png" width="80%" style="display: block; margin: auto;"></p>
<p>In the above plot, the upper and lower portions of the HDRs are cut
off. This is because the default behavior of <strong>ggdensity</strong>
is to not draw HDRs outside of the “bounding box” around observed data.
This is <em>not</em> because we are using a custom
<code>method_*()</code> function. To fix this, we need to either set a
better <code>ylim</code> value for <code><a href="../reference/geom_hdr.html">geom_hdr()</a></code> or specify a
larger range in <code><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous()</a></code>.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df_rot</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_hdr.html">geom_hdr</a></span><span class="op">(</span>method <span class="op">=</span> <span class="fu">method_mvnorm_ind</span><span class="op">(</span>circular <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">6</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">.4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html" class="external-link">coord_fixed</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">6</span>, <span class="fl">6</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">6</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df_rot</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_hdr.html">geom_hdr</a></span><span class="op">(</span>method <span class="op">=</span> <span class="fu">method_mvnorm_ind</span><span class="op">(</span>circular <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">.4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">6</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html" class="external-link">coord_fixed</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">6</span>, <span class="fl">6</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">6</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="method_files/figure-html/unnamed-chunk-18-1.png" width="45%"><img src="method_files/figure-html/unnamed-chunk-18-2.png" width="45%"></p>
<p>Notice, neither of these approaches involve arguments to
<code>method_mvnorm_ind()</code>. Internally, the closure returned by
<code>method_mvnorm_ind()</code> is used by <code><a href="../reference/get_hdr.html">get_hdr()</a></code>,
along with information from the <code>scales</code> associated with the
<code>ggplot</code> object. It is the <code>scales</code> that need
adjusting, not anything related to the <code>method</code> argument.</p>
</div>
<div class="section level3">
<h3 id="implementing-a-method-returning-an-evaluated-pdf">Implementing a method returning an evaluated PDF<a class="anchor" aria-label="anchor" href="#implementing-a-method-returning-an-evaluated-pdf"></a>
</h3>
<p>To illustrate the other case, in which the object returned by the
closure is the estimated density evaluated on a grid, we implement
<code>method_mvnorm_ind_grid()</code>. This estimates the same
independent normal density as <code>method_mvnorm_ind()</code>, the only
difference is the behavior of the returned closure.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">method_mvnorm_ind_grid</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">n</span>, <span class="va">rangex</span>, <span class="va">rangey</span><span class="op">)</span> <span class="op">{</span></span>
<span>    </span>
<span>    <span class="co"># First, we estimate the density -----------------------------</span></span>
<span>    </span>
<span>    <span class="va">xbar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">x</span><span class="op">)</span></span>
<span>    <span class="va">ybar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">y</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">sx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">x</span><span class="op">)</span></span>
<span>    <span class="va">sy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">y</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">f_est</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">xbar</span>, <span class="va">sx</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">ybar</span>, <span class="va">sy</span><span class="op">)</span></span>
<span>    </span>
<span>    </span>
<span>    <span class="co"># Return the density evaluated on a grid ---------------------</span></span>
<span>    </span>
<span>    <span class="co"># df_grid defined by rangex, rangey, and n</span></span>
<span>    <span class="va">df_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="va">rangex</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">rangex</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, length.out <span class="op">=</span> <span class="va">n</span><span class="op">)</span>,</span>
<span>      y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="va">rangey</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">rangey</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, length.out <span class="op">=</span> <span class="va">n</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">df_grid</span><span class="op">$</span><span class="va">fhat</span> <span class="op">&lt;-</span> <span class="fu">f_est</span><span class="op">(</span><span class="va">df_grid</span><span class="op">$</span><span class="va">x</span>, <span class="va">df_grid</span><span class="op">$</span><span class="va">y</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">df_grid</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span><span class="op">}</span></span></code></pre></div>
<p>See that returned closure has additional arguments <code>n</code>,
<code>rangex</code>, and <code>rangey</code> which define the grid.
Also, the grid is represented a <code>data.frame</code> with columns
<code>x</code>, <code>y</code>, and <code>fhat</code>, where
<code>fhat</code> is the (potentially unnormalized) density
estimate.</p>
<p>Again, to use our <code>method_mvnorm_ind_grid()</code> we provide it
to <code><a href="../reference/geom_hdr.html">geom_hdr()</a></code>’s method argument.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_hdr.html">geom_hdr</a></span><span class="op">(</span>method <span class="op">=</span> <span class="fu">method_mvnorm_ind_grid</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="method_files/figure-html/unnamed-chunk-20-1.png" width="80%" style="display: block; margin: auto;"></p>
<p>Like we saw in the previous example, we could prevent the HDRs from
being “cut off” by specifying either the <code>x/ylim</code> arguments
in <code><a href="../reference/geom_hdr.html">geom_hdr()</a></code> or by setting a larger range in
<code>scale_x/y_continuous()</code>.</p>
<!-- While we can represent this simple density estimator as either a function or grid, -->
<!-- there are many cases where it is not possible to represent estimators as functions in R. -->
<!-- For example, the previously discussed `method_kde()` demands a grid representation--the -->
<!-- underlying tool (`MASS::kde2d()`) represents the estimated density as a grid. -->
</div>
</div>
<div class="section level2">
<h2 id="the-method__1d-functions">The <code>method_*_1d()</code> functions<a class="anchor" aria-label="anchor" href="#the-method__1d-functions"></a>
</h2>
<p>We saw before that <strong>ggdensity</strong> uses
<code>method_*_1d()</code> functions for the estimation of 1-dimensional
densities. The internals of these functions are very similar to the
<code>method_*()</code> functions, the only differences are slight
changes to the arguments and return values of the returned closures.</p>
<p>Looking at the definition of <code><a href="../reference/method_kde_1d.html">method_kde_1d()</a></code>, we see the
returned closure has arguments <code>x</code>, <code>n</code>, and
<code>range</code>. This is very similar to <code><a href="../reference/method_kde.html">method_kde()</a></code>,
the only difference is we are now dealing with univariate data: the
vector argument <code>x</code> is used instead of <code>data</code>, and
we have a single <code>range</code> parameter instead of
<code>rangex</code> and <code>rangey</code>. Similarly, the closure now
returns the estimated density evaluated on a univariate grid, with
columns <code>x</code> and <code>fhat</code> instead of the bivariate
grid with columns <code>x</code>, <code>y</code>, and <code>fhat</code>.
Finally, see that <code><a href="../reference/method_kde_1d.html">method_kde_1d()</a></code> accepts several arguments
governing the density estimation procedure just like
<code><a href="../reference/method_kde.html">method_kde()</a></code>.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>method_kde_1d</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span> (<span class="at">bw =</span> <span class="st">"nrd0"</span>, <span class="at">adjust =</span> <span class="dv">1</span>, <span class="at">kernel =</span> <span class="st">"gaussian"</span>, <span class="at">weights =</span> <span class="cn">NULL</span>, </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">window =</span> kernel) </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">function</span>(x, n, range) {</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>        nx <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">is.null</span>(weights)) {</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>            weights <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span>nx, nx)</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> {</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>            weights <span class="ot">&lt;-</span> <span class="fu">normalize</span>(weights)</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>        dens <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">density</span>(x, <span class="at">bw =</span> bw, <span class="at">adjust =</span> adjust, <span class="at">kernel =</span> kernel, </span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">weights =</span> weights, <span class="at">window =</span> window, <span class="at">n =</span> n, <span class="at">from =</span> range[<span class="dv">1</span>], </span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">to =</span> range[<span class="dv">2</span>])</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>        <span class="fu">data.frame</span>(<span class="at">x =</span> dens<span class="sc">$</span>x, <span class="at">fhat =</span> dens<span class="sc">$</span>y)</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a><span class="sc">&lt;</span>bytecode<span class="sc">:</span> <span class="dv">0x560487b575c0</span><span class="sc">&gt;</span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a><span class="er">&lt;</span>environment<span class="sc">:</span> namespace<span class="sc">:</span>ggdensity<span class="sc">&gt;</span></span></code></pre></div>
<p>Estimated univariate densities can also be represented explicitly, as
illustrated by <code><a href="../reference/method_norm_1d.html">method_norm_1d()</a></code>. Comparing this to the
previously discussed <code><a href="../reference/method_mvnorm.html">method_mvnorm()</a></code> we see that little has
changed: the closure is now a function of a vector <code>x</code>
instead of <code>data</code> and returns a function of one variable
(<code>x</code>) instead of two (<code>x</code> and <code>y</code>).</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>method_norm_1d</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span> () </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">function</span>(x) {</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>        mu_hat <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>        sigma_hat <span class="ot">&lt;-</span> <span class="fu">sd</span>(x)</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">function</span>(x) <span class="fu">dnorm</span>(x, mu_hat, sigma_hat)</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="sc">&lt;</span>bytecode<span class="sc">:</span> <span class="dv">0x56048e331620</span><span class="sc">&gt;</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="er">&lt;</span>environment<span class="sc">:</span> namespace<span class="sc">:</span>ggdensity<span class="sc">&gt;</span></span></code></pre></div>
<p>Additional <code>method_*_1d()</code> functions can be implemented in
the same way as the 2-dimensional <code>method_*()</code> functions, so
long as the returned closure is structured in one of the two ways we
have seen here.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by James Otto, David Kahle.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
