<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Function used to specify univariate kernel density estimator
for get_hdr_1d() and layer functions (e.g. geom_hdr_rug())."><title>Univariate kernel density HDR estimator — method_kde_1d • ggdensity</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Univariate kernel density HDR estimator — method_kde_1d"><meta property="og:description" content="Function used to specify univariate kernel density estimator
for get_hdr_1d() and layer functions (e.g. geom_hdr_rug())."><meta property="og:image" content="https://jamesotto852.github.io/ggdensity/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ggdensity</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/method.html">The method argument</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/jamesotto852/ggdensity/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Univariate kernel density HDR estimator</h1>
      <small class="dont-index">Source: <a href="https://github.com/jamesotto852/ggdensity/blob/HEAD/R/method_1d.R" class="external-link"><code>R/method_1d.R</code></a></small>
      <div class="d-none name"><code>method_kde_1d.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Function used to specify univariate kernel density estimator
for <code><a href="get_hdr_1d.html">get_hdr_1d()</a></code> and layer functions (e.g. <code><a href="geom_hdr_rug.html">geom_hdr_rug()</a></code>).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">method_kde_1d</span><span class="op">(</span></span>
<span>  bw <span class="op">=</span> <span class="st">"nrd0"</span>,</span>
<span>  adjust <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  kernel <span class="op">=</span> <span class="st">"gaussian"</span>,</span>
<span>  weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  window <span class="op">=</span> <span class="va">kernel</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>bw</dt>
<dd><p>the smoothing bandwidth to be used.  The kernels are scaled
    such that this is the standard deviation of the smoothing kernel.
    (Note this differs from the reference books cited below, and from S-PLUS.)</p>
<p><code>bw</code> can also be a character string giving a rule to choose the
    bandwidth.  See <code><a href="https://rdrr.io/r/stats/bandwidth.html" class="external-link">bw.nrd</a></code>. <br> The default,
    <code>"nrd0"</code>, has remained the default for historical and
    compatibility reasons, rather than as a general recommendation,
    where e.g., <code>"SJ"</code> would rather fit, see also Venables and
    Ripley (2002).</p>
<p>The specified (or computed) value of <code>bw</code> is multiplied by
    <code>adjust</code>.</p></dd>


<dt>adjust</dt>
<dd><p>the bandwidth used is actually <code>adjust*bw</code>.
    This makes it easy to specify values like ‘half the default’
    bandwidth.</p></dd>


<dt>kernel, window</dt>
<dd><p>a character string giving the smoothing kernel
    to be used. This must partially match one of <code>"gaussian"</code>,
    <code>"rectangular"</code>, <code>"triangular"</code>, <code>"epanechnikov"</code>,
    <code>"biweight"</code>, <code>"cosine"</code> or <code>"optcosine"</code>, with default
    <code>"gaussian"</code>, and may be abbreviated to a unique prefix (single
    letter).</p>
<p><code>"cosine"</code> is smoother than <code>"optcosine"</code>, which is the
    usual ‘cosine’ kernel in the literature and almost MSE-efficient.
    However, <code>"cosine"</code> is the version used by S.</p></dd>


<dt>weights</dt>
<dd><p>numeric vector of non-negative observation weights,
    hence of same length as <code>x</code>. The default <code>NULL</code> is
    equivalent to <code>weights = rep(1/nx, nx)</code> where <code>nx</code> is the
    length of (the finite entries of) <code>x[]</code>.  If <code>na.rm = TRUE</code>
    and there are <code>NA</code>'s in <code>x</code>, they <em>and</em> the
    corresponding weights are removed before computations.  In that case,
    when the original weights have summed to one, they are re-scaled to
    keep doing so.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>For more details on the use and implementation of the <code>method_*_1d()</code> functions,
see <code><a href="../articles/method.html">vignette("method", "ggdensity")</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1e3</span>, sd <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="geom_hdr_rug.html">geom_hdr_rug</a></span><span class="op">(</span>method <span class="op">=</span> <span class="fu">method_kde_1d</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="method_kde_1d-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Details of the KDE can be adjusted with arguments to `method_kde_1d()`</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="geom_hdr_rug.html">geom_hdr_rug</a></span><span class="op">(</span>method <span class="op">=</span> <span class="fu">method_kde_1d</span><span class="op">(</span>adjust <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span>adjust <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="method_kde_1d-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="geom_hdr_rug.html">geom_hdr_rug</a></span><span class="op">(</span>method <span class="op">=</span> <span class="fu">method_kde_1d</span><span class="op">(</span>kernel <span class="op">=</span> <span class="st">"triangular"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span>kernel <span class="op">=</span> <span class="st">"triangular"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="method_kde_1d-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Can also be used with `get_hdr_1d()` for numerical summary of HDRs</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="get_hdr_1d.html">get_hdr_1d</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">x</span>, method <span class="op">=</span> <span class="fu">method_kde_1d</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> List of 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ df_est:'data.frame':	512 obs. of  4 variables:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ x               : num [1:512] -10.6 -10.6 -10.5 -10.5 -10.5 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ fhat            : num [1:512] 0.000667 0.000677 0.000688 0.000697 0.000707 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ fhat_discretized: num [1:512] 2.51e-05 2.55e-05 2.59e-05 2.62e-05 2.66e-05 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ hdr             : num [1:512] 1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ breaks: Named num [1:5] 0.00618 0.01973 0.05715 0.09498 Inf</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..- attr(*, "names")= chr [1:5] "99%" "95%" "80%" "50%" ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ data  :'data.frame':	1000 obs. of  2 variables:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ x             : num [1:1000] -2.658 -5.767 4.859 1.558 -0.168 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ hdr_membership: num [1:1000] 0.8 0.95 0.95 0.5 0.5 0.8 0.5 0.8 0.99 0.5 ...</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by James Otto, David Kahle.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

